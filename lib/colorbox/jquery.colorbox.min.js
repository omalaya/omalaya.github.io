(function($,h,j){var k={html:false,photo:false,iframe:false,inline:false,transition:"elastic",speed:300,fadeOut:300,width:false,initialWidth:"600",innerWidth:false,maxWidth:false,height:false,initialHeight:"450",innerHeight:false,maxHeight:false,scalePhotos:true,scrolling:true,opacity:0.9,preloading:true,className:false,overlayClose:true,escKey:true,arrowKey:true,top:false,bottom:false,left:false,right:false,fixed:false,data:undefined,closeButton:true,fastIframe:true,open:false,reposition:true,loop:true,slideshow:false,slideshowAuto:true,slideshowSpeed:2500,slideshowStart:"start slideshow",slideshowStop:"stop slideshow",photoRegex:/\.(gif|png|jp(e|g|eg)|bmp|ico|webp|jxr|svg)((#|\?).*)?$/i,retinaImage:false,retinaUrl:false,retinaSuffix:'@2x.$1',current:"image {current} of {total}",previous:"previous",next:"next",close:"close",xhrError:"This content failed to load.",imgError:"This image failed to load.",returnFocus:true,trapFocus:true,onOpen:false,onLoad:false,onComplete:false,onCleanup:false,onClosed:false,rel:function(){return this.rel},href:function(){return $(this).attr('href')},title:function(){return this.title},createImg:function(){var c=new Image();var d=$(this).data('cbox-img-attrs');if(typeof d==='object'){$.each(d,function(a,b){c[a]=b})}return c},createIframe:function(){var c=h.createElement('iframe');var d=$(this).data('cbox-iframe-attrs');if(typeof d==='object'){$.each(d,function(a,b){c[a]=b})}if('frameBorder'in c){c.frameBorder=0}if('allowTransparency'in c){c.allowTransparency="true"}c.name=(new Date()).getTime();c.allowFullscreen=true;return c}},colorbox='colorbox',prefix='cbox',boxElement=prefix+'Element',event_open=prefix+'_open',event_load=prefix+'_load',event_complete=prefix+'_complete',event_cleanup=prefix+'_cleanup',event_closed=prefix+'_closed',event_purge=prefix+'_purge',$overlay,$box,$wrap,$content,$topBorder,$leftBorder,$rightBorder,$bottomBorder,$related,$window,$loaded,$loadingBay,$loadingOverlay,$title,$current,$slideshow,$next,$prev,$close,$groupControls,$events=$('<a/>'),settings,interfaceHeight,interfaceWidth,loadedHeight,loadedWidth,index,photo,open,active,closing,loadingTimer,publicMethod,div="div",requests=0,previousCSS={},init;function $tag(a,b,c){var d=h.createElement(a);if(b){d.id=prefix+b}if(c){d.style.cssText=c}return $(d)}function winheight(){return j.innerHeight?j.innerHeight:$(j).height()}function Settings(c,d){if(d!==Object(d)){d={}}this.cache={};this.el=c;this.value=function(a){var b;if(this.cache[a]===undefined){b=$(this.el).attr('data-cbox-'+a);if(b!==undefined){this.cache[a]=b}else if(d[a]!==undefined){this.cache[a]=d[a]}else if(k[a]!==undefined){this.cache[a]=k[a]}}return this.cache[a]};this.get=function(a){var b=this.value(a);return $.isFunction(b)?b.call(this.el,this):b}}function getIndex(a){var b=$related.length,newIndex=(index+a)%b;return(newIndex<0)?b+newIndex:newIndex}function setSize(a,b){return Math.round((/%/.test(a)?((b==='x'?$window.width():winheight())/100):1)*parseInt(a,10))}function isImage(a,b){return a.get('photo')||a.get('photoRegex').test(b)}function retinaUrl(a,b){return a.get('retinaUrl')&&j.devicePixelRatio>1?b.replace(a.get('photoRegex'),a.get('retinaSuffix')):b}function trapFocus(e){if('contains'in $box[0]&&!$box[0].contains(e.target)&&e.target!==$overlay[0]){e.stopPropagation();$box.focus()}}function setClass(a){if(setClass.str!==a){$box.add($overlay).removeClass(setClass.str).addClass(a);setClass.str=a}}function getRelated(c){index=0;if(c&&c!==false&&c!=='nofollow'){$related=$('.'+boxElement).filter(function(){var a=$.data(this,colorbox);var b=new Settings(this,a);return(b.get('rel')===c)});index=$related.index(settings.el);if(index===-1){$related=$related.add(settings.el);index=$related.length-1}}else{$related=$(settings.el)}}function trigger(a){$(h).trigger(a);$events.triggerHandler(a)}var l=(function(){var a,className=prefix+"Slideshow_",click="click."+prefix,timeOut;function clear(){clearTimeout(timeOut)}function set(){if(settings.get('loop')||$related[index+1]){clear();timeOut=setTimeout(publicMethod.next,settings.get('slideshowSpeed'))}}function start(){$slideshow.html(settings.get('slideshowStop')).unbind(click).one(click,stop);$events.bind(event_complete,set).bind(event_load,clear);$box.removeClass(className+"off").addClass(className+"on")}function stop(){clear();$events.unbind(event_complete,set).unbind(event_load,clear);$slideshow.html(settings.get('slideshowStart')).unbind(click).one(click,function(){publicMethod.next();start()});$box.removeClass(className+"on").addClass(className+"off")}function reset(){a=false;$slideshow.hide();clear();$events.unbind(event_complete,set).unbind(event_load,clear);$box.removeClass(className+"off "+className+"on")}return function(){if(a){if(!settings.get('slideshow')){$events.unbind(event_cleanup,reset);reset()}}else{if(settings.get('slideshow')&&$related[1]){a=true;$events.one(event_cleanup,reset);if(settings.get('slideshowAuto')){start()}else{stop()}$slideshow.show()}}}}());function launch(a){var b;if(!closing){b=$(a).data(colorbox);settings=new Settings(a,b);getRelated(settings.get('rel'));if(!open){open=active=true;setClass(settings.get('className'));$box.css({visibility:'hidden',display:'block',opacity:''});$loaded=$tag(div,'LoadedContent','width:0; height:0; overflow:hidden; visibility:hidden');$content.css({width:'',height:''}).append($loaded);interfaceHeight=$topBorder.height()+$bottomBorder.height()+$content.outerHeight(true)-$content.height();interfaceWidth=$leftBorder.width()+$rightBorder.width()+$content.outerWidth(true)-$content.width();loadedHeight=$loaded.outerHeight(true);loadedWidth=$loaded.outerWidth(true);var c=setSize(settings.get('initialWidth'),'x');var d=setSize(settings.get('initialHeight'),'y');var e=settings.get('maxWidth');var f=settings.get('maxHeight');settings.w=Math.max((e!==false?Math.min(c,setSize(e,'x')):c)-loadedWidth-interfaceWidth,0);settings.h=Math.max((f!==false?Math.min(d,setSize(f,'y')):d)-loadedHeight-interfaceHeight,0);$loaded.css({width:'',height:settings.h});publicMethod.position();trigger(event_open);settings.get('onOpen');$groupControls.add($title).hide();$box.focus();if(settings.get('trapFocus')){if(h.addEventListener){h.addEventListener('focus',trapFocus,true);$events.one(event_closed,function(){h.removeEventListener('focus',trapFocus,true)})}}if(settings.get('returnFocus')){$events.one(event_closed,function(){$(settings.el).focus()})}}var g=parseFloat(settings.get('opacity'));$overlay.css({opacity:g===g?g:'',cursor:settings.get('overlayClose')?'pointer':'',visibility:'visible'}).show();if(settings.get('closeButton')){$close.html(settings.get('close')).appendTo($content)}else{$close.appendTo('<div/>')}load()}}function appendHTML(){if(!$box){init=false;$window=$(j);$box=$tag(div).attr({id:colorbox,'class':$.support.opacity===false?prefix+'IE':'',role:'dialog',tabindex:'-1'}).hide();$overlay=$tag(div,"Overlay").hide();$loadingOverlay=$([$tag(div,"LoadingOverlay")[0],$tag(div,"LoadingGraphic")[0]]);$wrap=$tag(div,"Wrapper");$content=$tag(div,"Content").append($current=$tag(div,"Current"),$prev=$('<button type="button"/>').attr({id:prefix+'Previous'}),$next=$('<button type="button"/>').attr({id:prefix+'Next'}),$slideshow=$('<button type="button"/>').attr({id:prefix+'Slideshow'}),$loadingOverlay);$close=$('<button type="button"/>').attr({id:prefix+'Close'});$wrap.append($tag(div).append($tag(div,"TopLeft"),$topBorder=$tag(div,"TopCenter"),$tag(div,"TopRight")),$tag(div,false,'clear:left').append($leftBorder=$tag(div,"MiddleLeft"),$content,$rightBorder=$tag(div,"MiddleRight")),$tag(div,false,'clear:left').append($tag(div,"BottomLeft"),$bottomBorder=$tag(div,"BottomCenter"),$tag(div,"BottomRight"))).find('div div').css({'float':'left'});$loadingBay=$tag(div,false,'position:absolute; width:9999px; visibility:hidden; display:none; max-width:none;');$groupControls=$next.add($prev).add($current).add($slideshow)}if(h.body&&!$box.parent().length){$(h.body).append($overlay,$box.append($wrap,$title=$tag(div,"Title"),$loadingBay))}}function addBindings(){function clickHandler(e){if(!(e.which>1||e.shiftKey||e.altKey||e.metaKey||e.ctrlKey)){e.preventDefault();launch(this)}}if($box){if(!init){init=true;$next.click(function(){publicMethod.next()});$prev.click(function(){publicMethod.prev()});$close.click(function(){publicMethod.close()});$overlay.click(function(){if(settings.get('overlayClose')){publicMethod.close()}});$(h).bind('keydown.'+prefix,function(e){var a=e.keyCode;if(open&&settings.get('escKey')&&a===27){e.preventDefault();publicMethod.close()}if(open&&settings.get('arrowKey')&&$related[1]&&!e.altKey){if(a===37){e.preventDefault();$prev.click()}else if(a===39){e.preventDefault();$next.click()}}});if($.isFunction($.fn.on)){$(h).on('click.'+prefix,'.'+boxElement,clickHandler)}else{$('.'+boxElement).live('click.'+prefix,clickHandler)}}return true}return false}if($[colorbox]){return}$(appendHTML);publicMethod=$.fn[colorbox]=$[colorbox]=function(b,c){var d;var e=this;b=b||{};if($.isFunction(e)){e=$('<a/>');b.open=true}if(!e[0]){return e}appendHTML();if(addBindings()){if(c){b.onComplete=c}e.each(function(){var a=$.data(this,colorbox)||{};$.data(this,colorbox,$.extend(a,b))}).addClass(boxElement);d=new Settings(e[0],b);if(d.get('open')){launch(e[0])}}return e};publicMethod.position=function(a,b){var c,top=0,left=0,offset=$box.offset(),scrollTop,scrollLeft;$window.unbind('resize.'+prefix);$box.css({top:-9e4,left:-9e4});scrollTop=$window.scrollTop();scrollLeft=$window.scrollLeft();if(settings.get('fixed')){offset.top-=scrollTop;offset.left-=scrollLeft;$box.css({position:'fixed'})}else{top=scrollTop;left=scrollLeft;$box.css({position:'absolute'})}if(settings.get('right')!==false){left+=Math.max($window.width()-settings.w-loadedWidth-interfaceWidth-setSize(settings.get('right'),'x'),0)}else if(settings.get('left')!==false){left+=setSize(settings.get('left'),'x')}else{left+=Math.round(Math.max($window.width()-settings.w-loadedWidth-interfaceWidth,0)/2)}if(settings.get('bottom')!==false){top+=Math.max(winheight()-settings.h-loadedHeight-interfaceHeight-setSize(settings.get('bottom'),'y'),0)}else if(settings.get('top')!==false){top+=setSize(settings.get('top'),'y')}else{top+=Math.round(Math.max(winheight()-settings.h-loadedHeight-interfaceHeight,0)/2)}$box.css({top:offset.top,left:offset.left,visibility:'visible'});$wrap[0].style.width=$wrap[0].style.height="9999px";function modalDimensions(){$topBorder[0].style.width=$bottomBorder[0].style.width=$content[0].style.width=(parseInt($box[0].style.width,10)-interfaceWidth)+'px';$content[0].style.height=$leftBorder[0].style.height=$rightBorder[0].style.height=(parseInt($box[0].style.height,10)-interfaceHeight)+'px'}c={width:settings.w+loadedWidth+interfaceWidth,height:settings.h+loadedHeight+interfaceHeight,top:top,left:left};if(a){var d=0;$.each(c,function(i){if(c[i]!==previousCSS[i]){d=a;return}});a=d}previousCSS=c;if(!a){$box.css(c)}$box.dequeue().animate(c,{duration:a||0,complete:function(){modalDimensions();active=false;$wrap[0].style.width=(settings.w+loadedWidth+interfaceWidth)+"px";$wrap[0].style.height=(settings.h+loadedHeight+interfaceHeight)+"px";if(settings.get('reposition')){setTimeout(function(){$window.bind('resize.'+prefix,publicMethod.position)},1)}if($.isFunction(b)){b()}},step:modalDimensions})};publicMethod.resize=function(a){var b;if(open){a=a||{};if(a.width){settings.w=setSize(a.width,'x')-loadedWidth-interfaceWidth}if(a.innerWidth){settings.w=setSize(a.innerWidth,'x')}$loaded.css({width:settings.w});if(a.height){settings.h=setSize(a.height,'y')-loadedHeight-interfaceHeight}if(a.innerHeight){settings.h=setSize(a.innerHeight,'y')}if(!a.innerHeight&&!a.height){b=$loaded.scrollTop();$loaded.css({height:"auto"});settings.h=$loaded.height()}$loaded.css({height:settings.h});if(b){$loaded.scrollTop(b)}publicMethod.position(settings.get('transition')==="none"?0:settings.get('speed'))}};publicMethod.prep=function(c){if(!open){return}var d,speed=settings.get('transition')==="none"?0:settings.get('speed');$loaded.remove();$loaded=$tag(div,'LoadedContent').append(c);function getWidth(){settings.w=settings.w||$loaded.width();settings.w=settings.mw&&settings.mw<settings.w?settings.mw:settings.w;return settings.w}function getHeight(){settings.h=settings.h||$loaded.height();settings.h=settings.mh&&settings.mh<settings.h?settings.mh:settings.h;return settings.h}$loaded.hide().appendTo($loadingBay.show()).css({width:getWidth(),overflow:settings.get('scrolling')?'auto':'hidden'}).css({height:getHeight()}).prependTo($content);$loadingBay.hide();$(photo).css({'float':'none'});setClass(settings.get('className'));d=function(){var b=$related.length,iframe,complete;if(!open){return}function removeFilter(){if($.support.opacity===false){$box[0].style.removeAttribute('filter')}}complete=function(){clearTimeout(loadingTimer);$loadingOverlay.hide();trigger(event_complete);settings.get('onComplete')};$title.html(settings.get('title')).show();$loaded.show();if(b>1){if(typeof settings.get('current')==="string"){$current.html(settings.get('current').replace('{current}',index+1).replace('{total}',b)).show()}$next[(settings.get('loop')||index<b-1)?"show":"hide"]().html(settings.get('next'));$prev[(settings.get('loop')||index)?"show":"hide"]().html(settings.get('previous'));l();if(settings.get('preloading')){$.each([getIndex(-1),getIndex(1)],function(){var a,i=$related[this],settings=new Settings(i,$.data(i,colorbox)),src=settings.get('href');if(src&&isImage(settings,src)){src=retinaUrl(settings,src);a=h.createElement('img');a.src=src}})}}else{$groupControls.hide()}if(settings.get('iframe')){iframe=settings.get('createIframe');if(!settings.get('scrolling')){iframe.scrolling="no"}$(iframe).attr({src:settings.get('href'),'class':prefix+'Iframe'}).one('load',complete).appendTo($loaded);$events.one(event_purge,function(){iframe.src="//about:blank"});if(settings.get('fastIframe')){$(iframe).trigger('load')}}else{complete()}if(settings.get('transition')==='fade'){$box.fadeTo(speed,1,removeFilter)}else{removeFilter()}};if(settings.get('transition')==='fade'){$box.fadeTo(speed,0,function(){publicMethod.position(0,d)})}else{publicMethod.position(speed,d)}};function load(){var c,setResize,prep=publicMethod.prep,$inline,request=++requests;active=true;photo=false;trigger(event_purge);trigger(event_load);settings.get('onLoad');settings.h=settings.get('height')?setSize(settings.get('height'),'y')-loadedHeight-interfaceHeight:settings.get('innerHeight')&&setSize(settings.get('innerHeight'),'y');settings.w=settings.get('width')?setSize(settings.get('width'),'x')-loadedWidth-interfaceWidth:settings.get('innerWidth')&&setSize(settings.get('innerWidth'),'x');settings.mw=settings.w;settings.mh=settings.h;if(settings.get('maxWidth')){settings.mw=setSize(settings.get('maxWidth'),'x')-loadedWidth-interfaceWidth;settings.mw=settings.w&&settings.w<settings.mw?settings.w:settings.mw}if(settings.get('maxHeight')){settings.mh=setSize(settings.get('maxHeight'),'y')-loadedHeight-interfaceHeight;settings.mh=settings.h&&settings.h<settings.mh?settings.h:settings.mh}c=settings.get('href');loadingTimer=setTimeout(function(){$loadingOverlay.show()},100);if(settings.get('inline')){var d=$(c).eq(0);$inline=$('<div>').hide().insertBefore(d);$events.one(event_purge,function(){$inline.replaceWith(d)});prep(d)}else if(settings.get('iframe')){prep(" ")}else if(settings.get('html')){prep(settings.get('html'))}else if(isImage(settings,c)){c=retinaUrl(settings,c);photo=settings.get('createImg');$(photo).addClass(prefix+'Photo').bind('error.'+prefix,function(){prep($tag(div,'Error').html(settings.get('imgError')))}).one('load',function(){if(request!==requests){return}setTimeout(function(){var a;if(settings.get('retinaImage')&&j.devicePixelRatio>1){photo.height=photo.height/j.devicePixelRatio;photo.width=photo.width/j.devicePixelRatio}if(settings.get('scalePhotos')){setResize=function(){photo.height-=photo.height*a;photo.width-=photo.width*a};if(settings.mw&&photo.width>settings.mw){a=(photo.width-settings.mw)/photo.width;setResize()}if(settings.mh&&photo.height>settings.mh){a=(photo.height-settings.mh)/photo.height;setResize()}}if(settings.h){photo.style.marginTop=Math.max(settings.mh-photo.height,0)/2+'px'}if($related[1]&&(settings.get('loop')||$related[index+1])){photo.style.cursor='pointer';$(photo).bind('click.'+prefix,function(){publicMethod.next()})}photo.style.width=photo.width+'px';photo.style.height=photo.height+'px';prep(photo)},1)});photo.src=c}else if(c){$loadingBay.load(c,settings.get('data'),function(a,b){if(request===requests){prep(b==='error'?$tag(div,'Error').html(settings.get('xhrError')):$(this).contents())}})}}publicMethod.next=function(){if(!active&&$related[1]&&(settings.get('loop')||$related[index+1])){index=getIndex(1);launch($related[index])}};publicMethod.prev=function(){if(!active&&$related[1]&&(settings.get('loop')||index)){index=getIndex(-1);launch($related[index])}};publicMethod.close=function(){if(open&&!closing){closing=true;open=false;trigger(event_cleanup);settings.get('onCleanup');$window.unbind('.'+prefix);$overlay.fadeTo(settings.get('fadeOut')||0,0);$box.stop().fadeTo(settings.get('fadeOut')||0,0,function(){$box.hide();$overlay.hide();trigger(event_purge);$loaded.remove();setTimeout(function(){closing=false;trigger(event_closed);settings.get('onClosed')},1)})}};publicMethod.remove=function(){if(!$box){return}$box.stop();$[colorbox].close();$box.stop(false,true).remove();$overlay.remove();closing=false;$box=null;$('.'+boxElement).removeData(colorbox).removeClass(boxElement);$(h).unbind('click.'+prefix).unbind('keydown.'+prefix)};publicMethod.element=function(){return $(settings.el)};publicMethod.settings=k}(jQuery,document,window));